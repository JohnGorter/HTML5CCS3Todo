<!DOCTYPE html>

<html>
    
<head>
    
    <title>Todo Application</title>
    <script src="http://code.jquery.com/jquery-1.11.1.js" type="text/javascript"></script>
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">

</head>



<script>
  $(function(){
    
    $.ajax({ url:'/todos', dataType:'JSON', success: function(data){
        for (todo in data)
            addTodo(data[todo].title, data[todo].description);
    }});
    
    $("span", $("#titlefield")).hide();
    $("span", $("#descrfield")).hide();

    $("#t").keyup(function(){validateInput($("#t"), $("#titlefield"))});
    $("#d").keyup(function(){validateInput($("#d"), $("#descrfield"))});
    
    $("#btnSave").click(function(){
        var t = $("#t");
        var d = $("#d");
    
        if (!validateInput(t, $("#titlefield"))) return;
        if (!validateInput(d, $("#descrField"))) return;
        
        addTodo(t.val(), d.val());
        
        $.ajax({ url:'/todos',
               type:'post',
               data: JSON.stringify({ title: t, description: d}),
               contentType: "application/json; charset=utf-8",
               success: function(data){
                    $("#notification").fadeIn().delay(5000).fadeOut();
               }});
    });
  });
  
  function validateInput(element, container){
    var value = $(element).val();
    $(container).removeClass("has-error");
    $("span", container).hide();
    if (!value) {
       $(container).addClass("has-error");
       $("span", container).show();
       return false;
    }
    return true;
  }

  function addTodo(title, description) {
    $("<li>")
            .append($("<span class='btn btn-danger btn-xs' style='margin-right:20px;margin-bottom:10px;'>").text("DEL").click(function(){ $(this).parent().remove();$("#dt").text(""); $("#dd").text("");}))
            .append($("<span>").addClass("t").text(title))
            .append($("<span>").addClass("h").text(description))
            .click(function(){ $("#dt").text($(".t",this).text()); $("#dd").text($(".h ",this).text());})
            .appendTo("#u");
  }
</script>

<style>
    body {
        text-align:center;
        font-variant: small-caps;
        }
    #form, #list, #detail {
        box-shadow: #000 5px 5px 15px;
        border:1px solid black;
        border-radius:15px;
        text-align:left;
        background:linear-gradient(yellow, white);
        padding:10px;
    }
    #form { margin-bottom:20px;}
    .h { display:none;}
    li { cursor:pointer; }
    ul { list-style: none;}
    #notification { border:1px solid black;margin-top:20px;}
    
</style>

<body>
    
    <h1 class="visible-sm visible-xs">Todo 2015(c) <small>John Gorter - Mobile</small> </h1>
    <h1 class="hidden-sm hidden-xs">Todo 2015(c) <small>John Gorter - Desktop</small></h1>
    
    
    <div class="container">
        
    
        <div class="row">
            <div class="col-xs-12 col-md-4">
                <div id="form">
                    <h1>Voeg een todo toe</h1>
                    <form class="form-horizontal" role="form">
                        <div class="form-group has-feedback" id="titlefield">
                            <label for="t" class="col-sm-2 control-label">Title</label>
                            <div class="col-sm-10">
                              <input type="text" class="form-control" id="t" placeholder="Title" name="t">
                              <span class='glyphicon glyphicon-remove form-control-feedback'></span>
                            </div>
                        </div>
                        <div class="form-group" id="descrfield">
                            <label for="d" class="col-sm-2 control-label">Description</label>
                            <div class="col-sm-10">
                              <textarea id="d" name="d" class="form-control" rows="3"></textarea>
                           </div>
                        </div>
                         <div class="form-group">
                            <div class="col-sm-offset-2 col-sm-10">
                               <input type="button" name="save" value="save" id="btnSave" class="btn btn-primary"/>
                            </div>
                        </div>
                    </form>    
                </div>
            </div>
            <div class="col-xs-6 col-md-4">
                <div id="list">
                    <h1>Lijst van todos</h1>
                    <ul id="u">
                    </ul>
                </div>
            </div>
            <div class="col-xs-6 col-md-4">
                <div id="detail">
                    <h1>Details</h1>
                    <b id="dt">Muur verven</b><br/>
                    <p id="dd">De muur in de schuur is behangen en moet nog worden geverfd.</p>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12 col-md-12">
                <div id="notification" style="display:none" class="bg-success">A new todo is added on the server</div>
            </div>
        </div>
    </div>
</body>

</html>
